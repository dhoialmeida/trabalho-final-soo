<!doctype html>
<html class="no-js" lang="" style="height: 100%">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Carlostream</title>
        <meta name="description" content="Carlostream - A melhor plataforma de streaming de videos">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body id="main">
        <div class="d-flex w-100 h-100 p-3 mx-auto flex-column" id="app">
            <header class="masthead mb-auto">
                <div class="inner">
                    <a href="/"><h3 class="masthead-brand">Carlostream</h3></a>
                    <nav class="nav nav-masthead justify-content-center">
                        <a class="nav-link" href="/filmes.html">Filmes</a>
                        <a class="nav-link" href="/series.html">Series</a>
                        <a class="nav-link" v-if="user !== null" href="/login.html">Fazer Logout ({{user.sub }})</a>
                        <a class="nav-link" v-if="user === null" href="/login.html">Fazer Login</a>
                        <a class="nav-link" v-if="user === null" href="/cadastrar_usuario.html">Cadastrar</a>
                    </nav>
                </div>
            </header>

            <div id="conteudoBox">
                <div class="d-flex justify-content-center" v-if="!loaded.conteudo">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
                <div class="d-flex justify-content-center" v-if="loaded.conteudo && fail.conteudo">
                    <strong>Erro ao carregar o conteúdo</strong>
                </div>
                <div v-if="loaded.conteudo && !fail.conteudo">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12">
                                <div class='embed-responsive embed-responsive-16by9'>
                                    <video class="embed-responsive-item" :src="'/uploaded/conteudo/video/' + conteudo.videoFile" controls></video>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <h3>{{conteudo.titulo}}</h3>
                            </div>
                            <div class="col-md-4 text-right">
                                <small v-if="conteudo.serie !== undefined">
                                    <a :href=" '/episodios.html?serie=' + conteudo.serie.idSerie + '#temporada' + conteudo.temporada ">Voltar para lista de episódios</a>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="mastfoot mt-auto">
                <div class="inner">
                    <p>Carlostream₢</p>
                </div>
            </footer>
        </div>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
        <script src="js/main.js"></script>
        <script>
    var url = new URL(window.location.href);
    var idConteudo = url.searchParams.get("idConteudo");

    $.ajax({
        url: "/api/conteudo/" + idConteudo,
        dataType: "json",
        cache: false,
        headers: {
            "Authorization": getCookie("bearer"),
        },
    }).done(function (json) {
        app.conteudo = json;
    }).fail(function (res) {
        handleError(res);
        app.fail.conteudo = true;
    }).always(function () {
        app.loaded.conteudo = true;
    });

    var app = new Vue({
        el: '#app',
        data: {
            conteudo: {},
            loaded: {
                conteudo: false,
                comentarios: false,
            },
            fail: {
                conteudo: false,
                comentarios: false,
            },
            comentarios: [],
            user: getUser(),
        }
    });
        </script>
    </body>
</html>
